{
  "version": 3,
  "sources": ["../src/komponentor.js"],
  "sourcesContent": ["/*!\n * Komponentor (single-file)\n * - Tree of components (parent/children), local scan\n * - Destroy cascades\n * - Optional hash router\n * - jQuery optional (used only as helper if present)\n *\n * Public API (minimal):\n *   komponentor.root(host, urlOrOpts)\n *   komponentor.mount(host, urlOrOpts)\n *   komponentor.scan(container?, { parent?, replaceExisting? })\n *   komponentor.route({ outlet, routes, notFound })\n *   komponentor.navigate(hash)\n *   komponentor.intent(urlOrOpts)  -> fluent .data(...).send({ parent })\n *   komponentor.runIntent(url, data, { parent })\n *\n * Mount option: replaceHost: true \u2014 replace the host element with the component root (host is removed; id is copied so e.g. #app still works). Destroy then removes the new root from DOM. remount() mounts onto the detached node unless you pass a new host.\n *\n * Component marker:\n *   <div data-komponent=\"/path/to/component.html|id=5|foo=bar\"></div>\n *\n * Intent usage examples:\n *   // From a component (intent becomes part of the branch; destroyed when parent is destroyed)\n *   async function init_komponent(k, data) {\n *     const i = await komponentor.intent(\"modal.html|id=1\").data({ source: k }).send({ parent: k });\n *     // i.ctx.ready, i.data; i may mount DOM via komponentor.mount(...) inside modal's init\n *   }\n *\n *   // Global intent (no parent; not attached to any component tree)\n *   const i = await komponentor.runIntent(\"service/worker.html\", { task: \"sync\" });\n */\n\n(function (global) {\n    \"use strict\";\n  \n    const $ = global.jQuery || null;\n  \n    // ----------------------------\n    // utils\n    // ----------------------------\n    const KEY_INST = \"__kp_instance__\";\n    const KEY_LOCK = \"__kp_mounting__\";\n  \n    function isPlainObject(x) {\n      return x && typeof x === \"object\" && x.constructor === Object;\n    }\n  \n    function uid(prefix = \"\") {\n      return (\n        prefix +\n        Math.random().toString(36).slice(2, 9) +\n        \"_\" +\n        Math.random().toString(36).slice(2, 7)\n      );\n    }\n  \n    function normalizeHost(host) {\n     \n      if (!host) throw new Error(\"Invalid host\");\n      if (typeof host === \"string\") {\n        const el = document.querySelector(host);\n        if (!el) throw new Error(`Host not found: ${host}`);\n        return el;\n      }\n      if ($ && host instanceof $) return host[0];\n      if (host instanceof Element) return host;\n      throw new Error(\"Invalid host type\");\n    }\n  \n    function getInst(el) {\n      return el ? el[KEY_INST] || null : null;\n    }\n    function setInst(el, inst) {\n      el[KEY_INST] = inst;\n    }\n    function clearInst(el, inst) {\n      if (el && el[KEY_INST] === inst) el[KEY_INST] = null;\n    }\n  \n    function lockHost(el, inst) {\n      // lock to prevent concurrent double-mount\n      if (el[KEY_LOCK]) return false;\n      el[KEY_LOCK] = inst || true;\n      return true;\n    }\n    function unlockHost(el, inst) {\n      if (!el) return;\n      if (el[KEY_LOCK] === inst || inst == null) el[KEY_LOCK] = null;\n    }\n  \n    function parseSpec(specText) {\n      // \"/a/b.html|x=1|y=2\" -> { url, data }\n      const out = { url: \"\", data: {} };\n      if (!specText) return out;\n      const parts = String(specText).split(\"|\");\n      out.url = parts.shift() || \"\";\n      parts.forEach((p) => {\n        if (!p) return;\n        const i = p.indexOf(\"=\");\n        if (i === -1) {\n          out.data[p] = null;\n        } else {\n          const k = p.slice(0, i);\n          const v = p.slice(i + 1);\n          out.data[k] = v === \"\" ? \"\" : v;\n        }\n      });\n      return out;\n    }\n\n    // data-komponent -> \"komponent\" (dataset key for exclusion)\n    function markerAttrToDatasetKey(attrName) {\n      if (!attrName || !String(attrName).toLowerCase().startsWith(\"data-\")) return null;\n      return String(attrName)\n        .slice(5)\n        .replace(/-([a-z])/g, (_, c) => c.toUpperCase());\n    }\n\n    // All data-* attributes from element as object (camelCase keys), excluding markerAttr\n    function getDataAttributesFromElement(el, markerAttr) {\n      if (!el || !el.dataset) return {};\n      const excludeKey = markerAttrToDatasetKey(markerAttr);\n      const out = {};\n      for (const key in el.dataset) {\n        if (key === excludeKey) continue;\n        out[key] = el.dataset[key];\n      }\n      return out;\n    }\n  \n    // ----------------------------\n    // EventBus (scoped)\n    // ----------------------------\n    class EventBus {\n      constructor() {\n        this._map = new Map(); // event -> [{fn,ctx}]\n      }\n      on(event, fn, ctx) {\n        if (typeof fn !== \"function\") return;\n        const arr = this._map.get(event) || [];\n        arr.push({ fn, ctx: ctx || null });\n        this._map.set(event, arr);\n      }\n      off(event, fn, ctx) {\n        const arr = this._map.get(event);\n        if (!arr) return;\n        this._map.set(\n          event,\n          arr.filter((l) => !(l.fn === fn && (ctx == null || l.ctx === ctx)))\n        );\n      }\n      emit(event, payload, thisArg) {\n        const arr = this._map.get(event);\n        if (!arr || !arr.length) return;\n        for (const l of arr.slice()) {\n          try {\n            l.fn.call(l.ctx || thisArg || null, payload);\n          } catch (e) {\n            // swallow: event handlers must not crash framework\n            // (caller can enable debug logs in config)\n          }\n        }\n      }\n      clear() {\n        this._map.clear();\n      }\n    }\n  \n    // ----------------------------\n    // Context (kernel)\n    // ----------------------------\n    class Context {\n      constructor(owner, manager) {\n        this.id = uid(\"k_\");\n        this.owner = owner; // Komponent instance\n        this.manager = manager; // Komponentor\n        this.parent = null;\n        this.children = [];\n        this.ready = false;\n        this._destroyed = false;\n  \n        this._state = \"initial\";\n        this._bus = new EventBus();\n        this._destroyers = [];\n  \n        // request lifecycle (1 active per context, abort on new/destroy)\n        this._req = { token: 0, ctrl: null };\n      }\n  \n      get state() {\n        return this._state;\n      }\n      set state(v) {\n        this._state = v;\n        this.trigger(\"state:change\", { state: v, ctx: this });\n        this.trigger(`state:${v}`, this);\n      }\n  \n      on(event, fn, ctx) {\n        this._bus.on(event, fn, ctx || this);\n        return this;\n      }\n      off(event, fn, ctx) {\n        this._bus.off(event, fn, ctx || this);\n        return this;\n      }\n      trigger(event, payload) {\n        this._bus.emit(event, payload, this);\n        return this;\n      }\n  \n      // bubble-up event (cross-branch through common ancestor)\n      emitUp(event, payload) {\n        let p = this.parent;\n        while (p) {\n          p.trigger(event, payload);\n          p = p.parent;\n        }\n        return this;\n      }\n  \n      // root-level event (global within app root)\n      emitRoot(event, payload) {\n        const root = this.manager && this.manager._rootCtx ? this.manager._rootCtx : null;\n        if (root) root.trigger(event, payload);\n        return this;\n      }\n  \n      onDestroy(fn) {\n        if (typeof fn === \"function\") this._destroyers.push(fn);\n        return this;\n      }\n  \n      requestAbort() {\n        try {\n          if (this._req.ctrl) this._req.ctrl.abort();\n        } catch (_) {}\n        this._req.ctrl = null;\n      }\n  \n      // fetch wrapper with stale-guard\n      async requestText(url, fetchOpts = {}) {\n        this._req.token += 1;\n        const t = this._req.token;\n  \n        this.requestAbort();\n        const ctrl = new AbortController();\n        this._req.ctrl = ctrl;\n  \n        const res = await fetch(url, Object.assign({}, fetchOpts, { signal: ctrl.signal }));\n        if (this._destroyed) return null;\n        if (t !== this._req.token) return null; // stale\n        if (!res.ok) throw new Error(`HTTP ${res.status} ${res.statusText}`);\n        const text = await res.text();\n        if (this._destroyed) return null;\n        if (t !== this._req.token) return null;\n        return text;\n      }\n  \n      destroy() {\n        if (this._destroyed) return;\n        this._destroyed = true;\n  \n        this.state = \"destroying\";\n        this.trigger(\"context:destroy\", this);\n  \n        this.requestAbort();\n  \n        // destroy children contexts first (safety)\n        const kids = this.children.slice();\n        this.children = [];\n        for (const ch of kids) {\n          try {\n            if (ch && typeof ch.destroy === \"function\") ch.destroy();\n          } catch (_) {}\n        }\n  \n        // run destroyers in reverse\n        const ds = this._destroyers.slice().reverse();\n        this._destroyers = [];\n        for (const fn of ds) {\n          try {\n            fn(this);\n          } catch (_) {}\n        }\n  \n        this._bus.clear();\n        this.ready = false;\n        this.state = \"destroyed\";\n      }\n    }\n  \n    // ----------------------------\n    // Komponent (node in tree)\n    // ----------------------------\n    class Komponent {\n      constructor(manager, host, opts) {\n        this.manager = manager;\n  \n        this.hostEl = normalizeHost(host);\n        this.$host = $ ? $(this.hostEl) : null;\n  \n        this.opts = manager._normalizeOpts(opts);\n        this.url = this.opts.url || \"\";\n        this.data = this.opts.data || {};\n  \n        this.parent = this.opts.parent || null;\n        this.children = [];\n        this._scanned = false;\n        this._destroyed = false;\n  \n        // mount \"lock\" early (prevents concurrent double-mount)\n        if (!lockHost(this.hostEl, this)) {\n          // if another mount is in-flight, best effort: return existing instance if any\n          const existing = getInst(this.hostEl);\n          if (existing) return existing;\n          // else: allow but it's risky; throw in debug\n          if (manager.config.debug) {\n            throw new Error(\"Host is already mounting (concurrent mount detected).\");\n          }\n        }\n  \n        // attach instance to host early (ownership)\n        setInst(this.hostEl, this);\n  \n        // context\n        this.ctx = new Context(this, manager);\n  \n        // link parent/child (component tree); parent may be Komponent or Intent\n        if (this.parent && (this.parent instanceof Komponent || this.parent instanceof Intent)) {\n          this.parent.children.push(this);\n          this.ctx.parent = this.parent.ctx;\n          this.parent.ctx.children.push(this.ctx);\n        }\n  \n        // cleanup ownership on destroy\n        this.ctx.onDestroy(() => {\n          unlockHost(this.hostEl, this);\n          clearInst(this.hostEl, this);\n        });\n      }\n  \n      // helper: scoped query\n      find(selector) {\n        return this.hostEl.querySelector(selector);\n      }\n\n      findAll(selector) {\n        return Array.from(this.hostEl.querySelectorAll(selector));\n      }\n  \n      // public: mount once (if re-called, destroys first by policy)\n      async mount() {\n        if (this._destroyed) return this;\n  \n        // policy: if mount called again, destroy then remount (user requested)\n        // (manager.mount() also enforces replace if needed)\n        this.ctx.state = \"loading\";\n  \n        try {\n          // overlay\n          if (this.opts.overlay !== false) this.manager.overlay.show(this);\n  \n          // fetch html\n          const url = this.manager._resolveUrl(this.url);\n          const htmlText = await this.ctx.requestText(url, this.manager.config.fetchOptions || {});\n          if (htmlText == null) return this;\n  \n          // parse -> template + init\n          const {fragment, init} = this.manager._parseHtml(htmlText, this);\n          this.ctx.state = \"rendering\";\n  \n          // render into host (replace contents)\n          this.manager._renderIntoHost(this, fragment);\n  \n          this.ctx.state = \"init\";\n          // run init (if exists)\n          if (typeof init === \"function\") {\n            await init(this, this.data);\n          }\n  \n          this.ctx.ready = true;\n          this.ctx.state = \"ready\";\n  \n          // auto-scan children (once per component lifetime)\n          if (this.opts.autoload !== false) {\n            this.scan({ replaceExisting: this.opts.replaceExistingChildren === true });\n          }\n  \n        } catch (e) {\n          this.ctx.state = \"error\";\n          this.manager._renderError(this, e);\n          if (this.manager.config.debug) this.manager.log(\"mount error\", e);\n        } finally {\n          this.manager.overlay.hide(this);\n          unlockHost(this.hostEl, this);\n        }\n  \n        return this;\n      }\n  \n      // scan local branch only\n      scan({ replaceExisting = false } = {}) {\n        if (this._destroyed) return this;\n  \n        // If your model says \"scan can be re-run and must replace\", you can allow it;\n        // but default stays \"once\" to keep branch stable unless explicitly changed.\n        if (this._scanned && replaceExisting !== true) return this;\n        this._scanned = true;\n  \n        this.manager.scan(this.hostEl, {\n          parent: this,\n          replaceExisting,\n        });\n  \n        return this;\n      }\n  \n      // explicit remount policy: destroy then mount\n      async remount() {\n        if (this._destroyed) return this;\n        this.destroy();\n        // create a fresh instance on same host\n        return this.manager.mount(this.hostEl, Object.assign({}, this.opts, { replace: true }));\n      }\n  \n      destroy() {\n        if (this._destroyed) return;\n        this._destroyed = true;\n  \n        // destroy children first (component-level)\n        const kids = this.children.slice();\n        this.children = [];\n        for (const ch of kids) {\n          try {\n            ch.destroy();\n          } catch (_) {}\n        }\n  \n        // context destroy (also destroys ctx children via ctx.children)\n        try {\n          this.ctx.destroy();\n        } catch (_) {}\n  \n        // DOM ownership cleanup\n        try {\n          if (this.opts.replaceHost) {\n            if (this.hostEl.parentNode) this.hostEl.parentNode.removeChild(this.hostEl);\n            clearInst(this.hostEl, this);\n          } else {\n            this.hostEl.innerHTML = \"\";\n          }\n        } catch (_) {}\n  \n        // unlink from parent component list (best effort)\n        if (this.parent && this.parent.children) {\n          const i = this.parent.children.indexOf(this);\n          if (i !== -1) this.parent.children.splice(i, 1);\n        }\n      }\n    }\n\n    // ----------------------------\n    // Intent (headless: no DOM, no render, no data-bind)\n    // ----------------------------\n    class Intent {\n      constructor(manager, opts) {\n        this.manager = manager;\n        opts = manager._normalizeIntentOpts(opts);\n        this.url = opts.url || \"\";\n        this.data = opts.data || {};\n        this.parent = opts.parent || null;\n        this.children = [];\n        this.hostEl = null;\n\n        this.ctx = new Context(this, manager);\n\n        if (this.parent && (this.parent instanceof Komponent || this.parent instanceof Intent)) {\n          this.parent.children.push(this);\n          this.ctx.parent = this.parent.ctx;\n          this.parent.ctx.children.push(this.ctx);\n        }\n      }\n\n      async run() {\n        if (this.ctx._destroyed) return this;\n        if (!this.url) {\n          this.ctx.state = \"error\";\n          this.manager.log(\"intent run: no url\");\n          return this;\n        }\n        this.ctx.state = \"loading\";\n        this.manager.log(\"intent run\", this.url);\n\n        try {\n          const url = this.manager._resolveUrl(this.url);\n          const htmlText = await this.ctx.requestText(url, this.manager.config.fetchOptions || {});\n          if (htmlText == null) return this;\n          const { fragment, init } = this.manager._parseHtml(htmlText, this);\n          this.hostEl = fragment.cloneNode(true);\n          console.log(\"hostEl\",this.hostEl);\n          //document.body.appendChild(this.hostEl);\n          this.ctx.state = \"init\";\n          if (typeof init === \"function\") {\n            await init(this, this.data);\n          }\n          this.ctx.ready = true;\n          this.ctx.state = \"ready\";\n        } catch (e) {\n          this.ctx.state = \"error\";\n          if (this.manager.config.debug) this.manager.log(\"intent run error\", this.url, e);\n        }\n        return this;\n      }\n\n      destroy() {\n        const kids = this.children.slice();\n        this.children = [];\n        for (const ch of kids) {\n          try {\n            if (ch && typeof ch.destroy === \"function\") ch.destroy();\n          } catch (_) {}\n        }\n        try {\n          this.ctx.destroy();\n        } catch (_) {}\n        if (this.parent && this.parent.children) {\n          const i = this.parent.children.indexOf(this);\n          if (i !== -1) this.parent.children.splice(i, 1);\n        }\n      }\n    }\n\n    // ----------------------------\n    // HashRouter (optional)\n    // ----------------------------\n    class HashRouter {\n      constructor(manager) {\n        this.manager = manager;\n        this._started = false;\n        this._handler = null;\n        this.routes = []; // [{ pattern, keys, regex, url }]\n        this.outlet = null;\n        this.notFound = null;\n      }\n  \n      // \"#/users/:id\" -> regex + keys\n      _compile(pattern) {\n        const keys = [];\n        let rx = \"^\" + pattern.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n        rx = rx.replace(/\\\\:([a-zA-Z0-9_]+)/g, (_, k) => {\n          keys.push(k);\n          return \"([^/]+)\";\n        });\n        rx += \"$\";\n        return { regex: new RegExp(rx), keys };\n      }\n  \n      configure({ outlet = \"#app\", routes = {}, notFound = null } = {}) {\n        this.outlet = outlet;\n        this.notFound = notFound;\n        this.routes = [];\n  \n        // accept object map or array\n        if (Array.isArray(routes)) {\n          routes.forEach((r) => this.add(r.path, r.url));\n        } else {\n          Object.entries(routes).forEach(([path, url]) => this.add(path, url));\n        }\n        return this;\n      }\n  \n      add(pathPattern, url) {\n        const c = this._compile(pathPattern);\n        this.routes.push({ pattern: pathPattern, keys: c.keys, regex: c.regex, url });\n        return this;\n      }\n  \n      match(hash) {\n        for (const r of this.routes) {\n          const m = r.regex.exec(hash);\n          if (!m) continue;\n          const params = {};\n          r.keys.forEach((k, i) => (params[k] = m[i + 1]));\n          return { url: r.url, route: { hash, params } };\n        }\n        return null;\n      }\n  \n      start() {\n        if (this._started) return;\n        this._started = true;\n  \n        this._handler = () => {\n          const hash = global.location.hash || \"#/\";\n          const match = this.match(hash);\n  \n          const outletEl = normalizeHost(this.outlet);\n          // replace root component on route change\n          if (!match) {\n            if (this.notFound) {\n              this.manager.mount(outletEl, {\n                url: this.notFound,\n                data: { route: { hash, params: {} } },\n                replace: true,\n                parent: null,\n              });\n            }\n            return;\n          }\n  \n          this.manager.mount(outletEl, {\n            url: match.url,\n            data: { route: match.route },\n            replace: true,\n            parent: null,\n          });\n        };\n  \n        global.addEventListener(\"hashchange\", this._handler);\n        global.addEventListener(\"load\", this._handler);\n        this._handler();\n      }\n  \n      stop() {\n        if (!this._started) return;\n        this._started = false;\n        if (this._handler) {\n          global.removeEventListener(\"hashchange\", this._handler);\n          global.removeEventListener(\"load\", this._handler);\n        }\n        this._handler = null;\n      }\n  \n      navigate(hash) {\n        global.location.hash = hash;\n      }\n    }\n  \n    // ----------------------------\n    // Komponentor (manager / API)\n    // ----------------------------\n    class Komponentor {\n      constructor(config = {}) {\n        this.config = Object.assign(\n          {\n            debug: false,\n            baseUrl: null,\n            // overlay:\n            overlayClass: \"komponent-overlay\",\n            overlayHtml:\n              \"<div style='position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)'>Loading</div>\",\n            // scan:\n            markerAttr: \"data-komponent\",\n            // error rendering:\n            errorHtml: (url, err) =>\n              `<div style=\"padding:8px;border:1px solid #c00;background:#fee\">Failed to load <b>${url}</b></div>`,\n          },\n          config\n        );\n  \n        this._root = null;    // Komponent\n        this._rootCtx = null; // Context (for root bus convenience)\n  \n        this.router = new HashRouter(this);\n  \n        // overlay service\n        this.overlay = {\n          show: (k) => this._overlayShow(k),\n          hide: (k) => this._overlayHide(k),\n        };\n      }\n  \n      log(...args) {\n        if (this.config.debug) console.log(\"[komponentor]\", ...args);\n      }\n  \n      _normalizeOpts(opts) {\n        if (typeof opts === \"string\") {\n          return { url: opts, data: {}, replace: false, autoload: true, overlay: true };\n        }\n        if (!isPlainObject(opts)) {\n          return { url: \"\", data: {}, replace: false, autoload: true, overlay: true };\n        }\n        const o = Object.assign(\n          {\n            url: \"\",\n            data: {},\n            replace: false,\n            replaceHost: false,  // if true, replace the host element with the component root (see docs)\n            autoload: true,  // default: scan data-komponent children after mount\n            overlay: true,\n            parent: null,\n          },\n          opts\n        );\n        // allow \"url|x=1|y=2\" in url field too\n        if (typeof o.url === \"string\" && o.url.includes(\"|\")) {\n          const parsed = parseSpec(o.url);\n          o.url = parsed.url;\n          o.data = Object.assign({}, parsed.data, o.data || {});\n        }\n        return o;\n      }\n\n      /** Intent opts only: url + data from spec and programmatic. No DOM/dataset. urlSpecData < programmaticData. */\n      _normalizeIntentOpts(urlOrOpts) {\n        let url = \"\";\n        let data = {};\n        let parent = null;\n        if (typeof urlOrOpts === \"string\") {\n          const parsed = parseSpec(urlOrOpts);\n          url = parsed.url;\n          data = Object.assign({}, parsed.data);\n        } else if (isPlainObject(urlOrOpts)) {\n          const o = urlOrOpts;\n          url = o.url || \"\";\n          const fromUrl = url && url.includes(\"|\") ? parseSpec(url).data : {};\n          data = Object.assign({}, fromUrl, o.data || {});\n          parent = o.parent != null ? o.parent : null;\n        }\n        return { url, data, parent };\n      }\n  \n      _resolveUrl(url) {\n        if (!url) return url;\n        if (this.config.baseUrl && url[0] === \"/\") return this.config.baseUrl + url;\n        return url;\n      }\n  \n      // parse HTML string into DOM fragment + init function (scoped, no global pollution)\n      _parseHtml(htmlText, komponent) {\n        // Put into template, strip <script>, keep scripts text, return fragment\n        const t = document.createElement(\"template\");\n        t.innerHTML = String(htmlText);\n  \n        const scripts = Array.from(t.content.querySelectorAll(\"script\"));\n        const code = scripts.map((s) => s.textContent || \"\").join(\"\\n\");\n        scripts.forEach((s) => s.remove());\n  \n        const fragment = t.content; // DocumentFragment\n  \n        // init extraction:\n        // Convention: scripts may define function init_komponent(k, data) { ... }\n        // We execute scripts in an isolated scope and then grab init_komponent if defined.\n        let init = null;\n        if (code.trim()) {\n          try {\n            // NOTE: This runs arbitrary code from fetched HTML. That's your current model.\n            // Keep it isolated (no global init function).\n            const fn = new Function(\n              \"komponent\",\n              \"data\",\n              \"komponentor\",\n              `\n              \"use strict\";\n              ${code}\n              // if code declared function init_komponent, it will overwrite our local binding only if it was declared as var/let assignment.\n              // to support \"function init_komponent(...) {}\", we detect it via Function constructor scope:\n              return (typeof init_komponent === \"function\") ? init_komponent : null;\n            `\n            );\n            // run once to obtain init function; then call later\n            const maybe = fn(komponent, komponent.data, this);\n            if (typeof maybe === \"function\") init = maybe;\n          } catch (e) {\n            if (this.config.debug) this.log(\"init parse error\", e);\n          }\n        }\n        return { fragment, init };\n      }\n  \n      _renderIntoHost(komponent, fragment) {\n        const host = komponent.hostEl;\n        if (komponent.opts.replaceHost) {\n          const parent = host.parentNode;\n          if (!parent) {\n            if (this.config.debug) this.log(\"replaceHost: host has no parent, falling back to append\");\n            host.innerHTML = \"\";\n            host.appendChild(fragment.cloneNode(true));\n            return;\n          }\n          const clone = fragment.cloneNode(true);\n          const childElements = clone.children ? Array.from(clone.children) : [];\n          let newRoot;\n          if (childElements.length === 1) {\n            newRoot = childElements[0];\n          } else if (childElements.length === 0) {\n            newRoot = document.createElement(\"div\");\n          } else {\n            newRoot = document.createElement(\"div\");\n            while (clone.firstChild) newRoot.appendChild(clone.firstChild);\n          }\n          if (host.id) newRoot.id = host.id;\n          parent.replaceChild(newRoot, host);\n          clearInst(host, komponent);\n          setInst(newRoot, komponent);\n          komponent.hostEl = newRoot;\n          if (komponent.$host) komponent.$host = $ ? $(newRoot) : null;\n        } else {\n          host.innerHTML = \"\";\n          host.appendChild(fragment.cloneNode(true));\n        }\n      }\n  \n      _renderError(komponent, err) {\n        try {\n          komponent.hostEl.innerHTML = this.config.errorHtml(komponent.url, err);\n        } catch (_) {}\n      }\n  \n      _overlayShow(k) {\n        const host = k.hostEl;\n        if (!host) return;\n  \n        // If host isn't positioned, overlay absolute positioning is messy; simplest:\n        // create overlay as first child with position:relative wrapper.\n        // Minimal, predictable.\n        // You can replace this later with a better overlay implementation.\n  \n        // avoid duplicate overlay\n        if (k._overlayEl && k._overlayEl.parentNode) return;\n  \n        const ov = document.createElement(\"div\");\n        ov.className = this.config.overlayClass;\n        ov.innerHTML = this.config.overlayHtml;\n  \n        ov.style.position = \"relative\";\n        ov.style.minHeight = \"30px\";\n        ov.style.border = \"1px dashed silver\";\n        ov.style.background = \"#eee\";\n        ov.style.zIndex = \"999999\";\n  \n        k._overlayEl = ov;\n        host.insertBefore(ov, host.firstChild);\n      }\n  \n      _overlayHide(k) {\n        const ov = k._overlayEl;\n        if (ov && ov.parentNode) ov.parentNode.removeChild(ov);\n        k._overlayEl = null;\n      }\n  \n      // ---------- Public API ----------\n      root(host, urlOrOpts) {\n        console.log(\"root\", host);\n        const el = normalizeHost(host);\n        console.log(\"el\", el);\n        // destroy existing root if any\n        if (this._root) {\n          try {\n            this._root.destroy();\n          } catch (_) {}\n          this._root = null;\n          this._rootCtx = null;\n        }\n        const k = this.mount(el, Object.assign({}, this._normalizeOpts(urlOrOpts), { replace: true, parent: null }));\n        this._root = k;\n        this._rootCtx = k && k.ctx ? k.ctx : null;\n        return k;\n      }\n  \n      mount(host, urlOrOpts) {\n        const el = normalizeHost(host);\n        const opts = this._normalizeOpts(urlOrOpts);\n  \n        // policy requested by you:\n        // - if mounting onto a host that already has a component, destroy first\n        const existing = getInst(el);\n        \n        if (existing && existing instanceof Komponent && opts.replace) existing.destroy();\n        if (existing && !opts.replace) return existing;\n  \n        // create new component\n        const k = new Komponent(this, el, opts);\n  \n        // run mount async (fire-and-forget); user can await if they want:\n        // return k.mount() would change API; so keep instance return and let user await k.mount() optionally.\n        k.mount();\n  \n        return k;\n      }\n  \n      scan(container = document.body, { parent = null, replaceExisting = false } = {}) {\n        const root = normalizeHost(container);\n        const attr = this.config.markerAttr;\n\n        const nodes = Array.from(root.querySelectorAll(`[${attr}]`));\n        for (const node of nodes) {\n          const spec = node.getAttribute(attr) || \"\";\n          const parsed = parseSpec(spec);\n          const dataFromAttrs = getDataAttributesFromElement(node, attr);\n          const data = Object.assign({}, parsed.data, dataFromAttrs);\n\n          const existing = getInst(node);\n          if (existing && !replaceExisting) continue;\n\n          if (existing && replaceExisting) {\n            try {\n              existing.destroy();\n            } catch (_) {}\n          }\n\n          this.mount(node, {\n            url: parsed.url,\n            data,\n            parent: parent,\n            replace: true,\n          });\n        }\n      }\n  \n      route({ outlet = \"#app\", routes = {}, notFound = null } = {}) {\n        this.router.configure({ outlet, routes, notFound }).start();\n      }\n  \n      navigate(hash) {\n        this.router.navigate(hash);\n      }\n\n      /** Fluent intent builder. .data(objOrKey, val).send({ parent }) -> Intent (after run). */\n      intent(urlOrOpts) {\n        const manager = this;\n        const opts = manager._normalizeIntentOpts(urlOrOpts);\n        let _url = opts.url;\n        let _data = Object.assign({}, opts.data);\n        return {\n          data(objOrKey, val) {\n            if (objOrKey != null && typeof objOrKey === \"object\") {\n              Object.assign(_data, objOrKey);\n            } else if (objOrKey != null) {\n              _data[objOrKey] = val;\n            }\n            return this;\n          },\n          async send({ parent } = {}) {\n            const intent = new Intent(manager, { url: _url, data: _data, parent });\n            await intent.run();\n            return intent;\n          },\n        };\n      }\n\n      /** Convenience: runIntent(url, data, { parent }) -> Intent (after run). */\n      async runIntent(url, data, { parent } = {}) {\n        const opts = this._normalizeIntentOpts({ url, data });\n        const intent = new Intent(this, { url: opts.url, data: opts.data, parent });\n        await intent.run();\n        return intent;\n      }\n    }\n  \n    // ----------------------------\n    // expose namespace\n    // ----------------------------\n    const K = global.komponentor = global.komponentor || {};\n    // If user already has an instance, keep it; else create default instance\n    if (!(K instanceof Komponentor)) {\n      const inst = new Komponentor(K && isPlainObject(K) ? K : {});\n      // copy instance onto global\n      global.komponentor = inst;\n    }\n  \n    // also expose classes for power users\n    global.komponentor.Komponentor = Komponentor;\n    global.komponentor.Komponent = Komponent;\n    global.komponentor.Context = Context;\n    global.komponentor.HashRouter = HashRouter;\n    global.komponentor.Intent = Intent;\n  \n  })(window);\n  "],
  "mappings": "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",
  "names": ["global", "$", "KEY_INST", "KEY_LOCK", "isPlainObject", "x", "uid", "prefix", "normalizeHost", "host", "el", "getInst", "setInst", "inst", "clearInst", "lockHost", "unlockHost", "parseSpec", "specText", "out", "parts", "p", "i", "k", "v", "markerAttrToDatasetKey", "attrName", "_", "c", "getDataAttributesFromElement", "markerAttr", "excludeKey", "key", "EventBus", "event", "fn", "ctx", "arr", "l", "payload", "thisArg", "Context", "owner", "manager", "root", "url", "fetchOpts", "t", "ctrl", "res", "text", "kids", "ch", "ds", "Komponent", "opts", "existing", "Intent", "selector", "htmlText", "fragment", "init", "e", "replaceExisting", "HashRouter", "pattern", "keys", "rx", "outlet", "routes", "notFound", "r", "path", "pathPattern", "hash", "m", "params", "match", "outletEl", "Komponentor", "config", "err", "args", "o", "parsed", "urlOrOpts", "data", "parent", "fromUrl", "komponent", "scripts", "code", "s", "maybe", "clone", "childElements", "newRoot", "ov", "container", "attr", "nodes", "node", "spec", "dataFromAttrs", "_url", "_data", "objOrKey", "val", "intent", "K"]
}
