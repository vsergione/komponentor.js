/*! komponentor v1.0.0
 * A jQuery plugin to create modular web apps
 * (c) 2025 
 * Released under the MIT License
 */
!function(t){const o={routes:{},currentRoute:null,defaultRoute:null,container:null,options:{accessControl:t=>!0,debug:!1,autoInit:!0}},e=(...t)=>{o.options.debug&&(console.log("[KomponentorRouter]",...t),console.trace("[KomponentorRouter]"))};o.init=function(o={}){return e("Router.init",o),Object.assign(this.options,o),o.container&&(this.container=t(o.container)),o.defaultRoute&&(this.defaultRoute=o.defaultRoute),o.routes&&(this.routes=o.routes),window.addEventListener("load",(t=>this.handleRoute(t))),window.addEventListener("hashchange",(t=>{t.preventDefault(),this.handleRoute(t)})),e("Router initialized",this.options),this},o.route=function(t,o){return"string"==typeof o&&(o={url:o}),this.routes[t]=o,e("Route added",t,o),this},o.parseRoute=function(){const t=window.location.hash.substring(1)||this.defaultRoute||"",[o,...e]=t.split("|"),n={};return e.forEach((t=>{const[o,e]=t.split("=");n[o]=e})),{path:o,params:n,hash:t}},o.handleRoute=async function(o){const n=this.parseRoute();if(this.currentRoute&&this.currentRoute.hash===n.hash)return void e("Hash unchanged, skipping route handling");let r=null;const i=Object.keys(this.routes).sort().reverse();for(let t=0;t<i.length;t++)if(n.path.match(new RegExp("^"+i[t]+"$"))){r=this.routes[i[t]];break}if(this.options.accessControl){if(!await this.options.accessControl(n))return void e("Access denied for route",n.path)}if(e("Handling route",n,r),!r)return e("No handler found for route",n.path),void(this.defaultRoute&&n.path!==this.defaultRoute&&this.navigate(this.defaultRoute));try{if("function"==typeof r&&(r=await r(n)),e("handler",r),"string"==typeof r&&(r={url:r}),"object"==typeof r){if(!this.container)throw new Error("No container specified for component rendering");this.container.empty();const o=t("<komponent>").appendTo(this.container);await o.komponent({...r,data:{...r.data,...n.params}})}this.currentRoute=n,e("Route handled successfully",n)}catch(t){console.error("Error handling route:",t)}},o.navigate=function(t,o={}){const e=Object.entries(o).map((([t,o])=>`${t}=${o}`)).join("|"),n=e?`${t}|${e}`:t;window.location.hash=n},o.getCurrentRoute=function(){return this.currentRoute},window.krouter=o,void 0!==window.komponentor||console.error("Komponentor not found. Make sure komponentor.modern.js is loaded first.")}(jQuery);
//# sourceMappingURL=krouter.min.js.map
